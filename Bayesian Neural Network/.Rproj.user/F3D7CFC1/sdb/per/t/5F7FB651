{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Convergence Diagnostics\"\nauthor: \"Umbertol Junior Mele 1388371\"\ndate: \"29 settembre 2017\"\noutput: pdf_document\n---\n## first case Muller Rios Insua priors\n\n\\centering\n\n#### Posterior marginal \n\n```{r, echo=FALSE}\ntake_the_weight <- function(index){\n  dim <- length(index)\n  for(i in 1:dim){\n    i <- as.character(index[i])\n    if(length(grep('Beta.0', i))){\n      val <- net.1$weights[[1]][[2]][1]\n      i <-''\n    }\n    if(length(grep(\"Beta\", i))){\n      v <- as.numeric(gsub(\".*([0-9]+).*$\", \"\\\\1\", index))\n      val <- net.1$weights[[1]][[2]][1+v]\n      i <-''\n    }\n    if(length(grep('Gamma.0', i))){\n      v <- as.numeric(gsub(\".*([0-9]+).*$\", \"\\\\1\", index))\n      val <- net.1$weights[[1]][[1]][1,v]\n      i <-''\n    }\n    if(length(grep(\"Gamma\", i))){\n      v <- as.numeric(unlist(strsplit(gsub(\".*([0-9]+,[0-9]+).*$\", \"\\\\1\", index),',')))\n      val <- net.1$weights[[1]][[1]][v[2],v[1]]\n      i <-''\n    }\n  }\n  return(val)\n}\n\n```\n\n\n```{r,echo=FALSE}\n#obs 1000\nload('data_simmulated_for_neal.RData')\nload('network_for_K_15_1000.RData')\nload('chains_for_muller_plot.RData')\n\n# looking to marginal distributions..\nopt1 <- take_the_weight(ind[l[1],1])\nopt2 <- take_the_weight(ind[l[2],1])\nopt3 <- take_the_weight(ind[l[3],1])\nopt4 <- take_the_weight(ind[l[4],1])\n\npar(mfrow=c(2,2), mar=c(2.5,2.5,1.5,2.5))\nplot(density(s1), main = ind[l[1],1])\npoints(opt1,0, col='blue')\nplot(density(s2), main = ind[l[2],1])\npoints(opt2,0, col='blue')\nplot(density(s3), main = ind[l[3],1])\npoints(opt3,0, col='blue')\nplot(density(s4), main = ind[l[4],1])\npoints(opt3,0, col='blue')\n```\n\n\n\\centering\n\\begin{tabular}{rrrrr}\n  \\hline\n & lower & upper & opt & p\\_val \\\\ \n  \\hline\n1 & -34.41 & -27.56 & 1.09 & 0.00 \\\\ \n  2 & -2.38 & -2.16 & -0.66 & 0.00 \\\\ \n  3 & -2.98 & -2.48 & -0.71 & 0.00 \\\\ \n  4 & -0.26 & -0.02 & 1.12 & 0.00 \\\\ \n   \\hline\n\\end{tabular}\n\n\\newpage\n\n#### Traceplots marginals\n\n```{r, echo=FALSE}\npar(mfrow=c(2,2), mar=c(2.5,2.5,1.5,2.5))\nts.plot(s1, main = ind[l[1],1])\nts.plot(s2, main = ind[l[2],1])\nts.plot(s3, main = ind[l[3],1])\nts.plot(s4, main = ind[l[4],1])\n\n```\n\n\\newpage\n\n#### Running means plot\n\n```{r,echo=FALSE}\npar(mfrow=c(2,2), mar=c(2.5,2.5,1.5,2.5))\nts.plot(cumsum(s1)/seq_along(s1), main = ind[l[1],1])\nts.plot(cumsum(s2)/seq_along(s2), main = ind[l[2],1])\nts.plot(cumsum(s2)/seq_along(s3), main = ind[l[3],1])\nts.plot(cumsum(s4)/seq_along(s4), main = ind[l[4],1])\n\n```\n\n\\newpage\n\n#### Auto correlation\n\n```{r, echo=FALSE}\n# Auto-correlation functions\npar(mfrow=c(2,2), mar=c(2.5,2.5,1.5,2.5))\nacf(s1,10000, main = ind[l[1],1])\nacf(s2,10000, main = ind[l[2],1])\nacf(s3,10000, main = ind[l[3],1])\nacf(s4,10000, main = ind[l[4],1])\n```\n\n\\newpage\n\n#### Cross-correlation\n\n```{r,echo=FALSE}\npar(mfrow=c(2,2), mar=c(2.5,2.5,1.5,2.5))\nccf(s1, s2,10000, main='Cross-corr Beta1-Beta0')\nccf(s1, s3,10000, main='Cross-corr Beta1-Gamma[2,1]')\nccf(s1, s4,10000, main='Cross-corr Beta1-Gamma[1,2]')\n```\n\n\\newpage\n\n#### Spectral analysis\n\nUsing coda Geweke Convergence diagnostic, I have this result:\n\n\\centering\n\\begin{tabular}{rlll}\n  \\hline\n & chain & Z\\_score & p\\_value \\\\ \n  \\hline\n1 & Beta1 & -6.4 & 7.5e-11 \\\\ \n  2 & Beta0 & 2.92 & 0.0017 \\\\ \n  3 & gamma 2,1 & 4.31 & 8.058e-06 \\\\ \n  4 & gamma 1,2 & -4.143 & 1.715e-05 \\\\ \n   \\hline\n\\end{tabular}\n\\end{table}\n\nUsing coda Heidelberger and Welch Convergence diagnostic, I have this result:\n\n```{r, echo=FALSE}\nrequire(coda)\n\nheidel.diag(s1)\nheidel.diag(s2)\nheidel.diag(s3)\nheidel.diag(s4)\n```\n\n\\newpage\n\n#### Predictive Posterior distribution analysis\n\n```{r, echo=FALSE}\nM = 10000\nind <- read.csv(file = \"muller_rois_index.txt\", sep = '\\t', header = F)\nc <- dim(ind)[1]\nobj <- read.csv(file = \"muller_rois_chain.txt\", sep = '\\t', header = F)\nchain_muller_Rios <- matrix(obj[,2], c(M,c))\n\n```\n\n\n```{r,echo=FALSE, fig.height=12, fig.width=10}\npar(mfrow=c(5,5), mar=c(2.5,2.5,1.5,2.5))\no <- sample(x =0:1000, size = 25)\nfor(obs in 1:25){\n  l= 106+ o[obs]\n  pred_ind <- ind[l,1]\n  sim <- chain_muller_Rios[,l]\n  plot(density(sim), main = ind[l,1])\n  points(Y[obs],0, col = 'blue')\n  p_val <- sum(sim <=Y[obs])/length(sim)\n  p_val <- min(p_val, 1- p_val)\n  legend('topleft',legend = bquote(p-value ~ \"=\" ~ .(p_val)),lty = 1:2, cex = 0.5)\n}\n\n```\n\n\\newpage\n\n#### visualizing the posterior log-likelihood\n\n```{r, echo=FALSE}\n# visualizing the posterior log-likelihood\npred_ind <- ind[1108:2107,1]\np.log <- rowSums(chain_muller_Rios[,pred_ind])\nts.plot(p.log)\n\n```\n\n",
    "created" : 1506703891125.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "728740726",
    "id" : "5F7FB651",
    "lastKnownWriteTime" : 1506704199,
    "last_content_update" : 1506704199326,
    "path" : "C:/Users/Umbertojunior/Desktop/data science/Second Semestr/SDS 2/project/Bayesian Neural Network/presentation/plot_figure.Rmd",
    "project_path" : "presentation/plot_figure.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}